<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <title>Memcache Functions</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
 </head>
 <body><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="function.m-verifysslcert.html">m_verifysslcert</a></div>
 <div class="next" style="float: right;"><a href="function.Memcache-add.html">Memcache::add</a></div>
 <div class="up"><a href="funcref.html">Function Reference</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div>
  <h1 class="title">Memcache Functions</h1>
  

  <div class="partintro">
   <div id="memcache.intro" class="section">
    <h2 class="title">Introduction</h2>
    <p class="para">
     Memcache module provides handy procedural and object oriented interface
     to memcached, highly effective caching daemon, which was especially
     designed to decrease database load in dynamic web applications.
    </p>
    <p class="para">
     The Memcache module also provides a <a href="ref.session.html" class="link">session</a> handler (<i class="literal">memcache</i>).
    </p>
    <p class="para">
     More information about memcached can be found at <a href="http://www.danga.com/memcached/" class="link external">&raquo; http://www.danga.com/memcached/</a>.
    </p>
   </div>

   <div id="memcache.requirements" class="section">
    <h2 class="title">Requirements</h2>
    <p class="para">
     This module uses functions of <a href="http://www.zlib.net/" class="link external">&raquo; zlib</a>
     to support on-the-fly data compression. Zlib is required to install
     this module.
    </p>
    <p class="para">
     PHP 4.3.3 or newer is required to use the memcache extension.
    </p>
   </div>

   

<div id="memcache.installation" class="section">
 <h2 class="title">Installation</h2>
 <p class="para">
  This <a href="http://pecl.php.net/" class="link external">&raquo; PECL</a> extension
is not bundled with PHP.
  Information for installing this PECL extension may be
found in the manual chapter titled <a href="install.pecl.html" class="link">Installation 
of PECL extensions</a>. Additional information such as new releases,
downloads, source files, maintainer information, and a CHANGELOG, can be
located here: 
  <a href="http://pecl.php.net/package/memcache" class="link external">&raquo; http://pecl.php.net/package/memcache</a>.
 </p>
 <p class="para">
  In order to use these functions you must compile PHP with Memcache support
  by using the <span class="option">--enable-memcache[=DIR]</span> option.
  You may optionally disable memcache session handler support by specifying
  <span class="option">--disable-memcache-session</span>.
 </p>
 <p class="para">
  Windows users will enable <var class="filename">php_memcache.dll</var> inside
  of <var class="filename">php.ini</var> in order to use these functions.
  
The <acronym title="Dynamic Link Library">DLL</acronym> for this <acronym title="PHP Extension and Application Repository">PECL</acronym> extension
may be downloaded from either the 
<a href="http://www.php.net/downloads.php" class="link external">&raquo; PHP Downloads</a> page or from 
<a href="http://pecl4win.php.net/" class="link external">&raquo; http://pecl4win.php.net/</a>
 </p>
</div>



   

<div id="memcache.ini" class="section">
 <h2 class="title">Runtime Configuration</h2>
 <p class="simpara">
The behaviour of these functions is affected by settings in <var class="filename">php.ini</var>.
</p>
 <p class="para">
  <table border="5">
   <caption><b>Memcache Configuration Options</b></caption>
   <colgroup>

    <thead valign="middle">
     <tr valign="middle">
      <th colspan="1">Name</th>
      <th colspan="1">Default</th>
      <th colspan="1">Changeable</th>
      <th colspan="1">Changelog</th>
     </tr>

    </thead>

    <tbody valign="middle">
     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">memcache.allow_failover</td>
      <td colspan="1" rowspan="1" align="left">&quot;1&quot;</td>
      <td colspan="1" rowspan="1" align="left">PHP_INI_ALL</td>
      <td colspan="1" rowspan="1" align="left">Available since memcache 2.0.2.</td>
     </tr>

     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">memcache.max_failover_attempts</td>
      <td colspan="1" rowspan="1" align="left">&quot;20&quot;</td>
      <td colspan="1" rowspan="1" align="left">PHP_INI_ALL</td>
      <td colspan="1" rowspan="1" align="left">Available since memcache 2.1.0.</td>
     </tr>

     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">memcache.chunk_size</td>
      <td colspan="1" rowspan="1" align="left">&quot;8192&quot;</td>
      <td colspan="1" rowspan="1" align="left">PHP_INI_ALL</td>
      <td colspan="1" rowspan="1" align="left">Available since memcache 2.0.2.</td>
     </tr>

     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">memcache.default_port</td>
      <td colspan="1" rowspan="1" align="left">&quot;11211&quot;</td>
      <td colspan="1" rowspan="1" align="left">PHP_INI_ALL</td>
      <td colspan="1" rowspan="1" align="left">Available since memcache 2.0.2.</td>
     </tr>

     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">memcache.hash_strategy</td>
      <td colspan="1" rowspan="1" align="left">&quot;standard&quot;</td>
      <td colspan="1" rowspan="1" align="left">PHP_INI_ALL</td>
      <td colspan="1" rowspan="1" align="left">Available since memcache 2.2.0.</td>
     </tr>

     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">memcache.hash_function</td>
      <td colspan="1" rowspan="1" align="left">&quot;crc32&quot;</td>
      <td colspan="1" rowspan="1" align="left">PHP_INI_ALL</td>
      <td colspan="1" rowspan="1" align="left">Available since memcache 2.2.0.</td>
     </tr>

     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">session.save_handler</td>
      <td colspan="1" rowspan="1" align="left">&quot;files&quot;</td>
      <td colspan="1" rowspan="1" align="left">PHP_INI_ALL</td>
      <td colspan="1" rowspan="1" align="left">Supported since memcache 2.1.2</td>
     </tr>

     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">session.save_path</td>
      <td colspan="1" rowspan="1" align="left">&quot;&quot;</td>
      <td colspan="1" rowspan="1" align="left">PHP_INI_ALL</td>
      <td colspan="1" rowspan="1" align="left">Supported since memcache 2.1.2</td>
     </tr>

    </tbody>
   </colgroup>

  </table>

  For further details and definitions of the 
PHP_INI_* constants, see the <a href="ini.html" class="xref">php.ini directives</a>.
 </p>

<p class="para">Here&#039;s a short explanation of
the configuration directives.</p>

<p class="para">
 <dl>

  
  <dt id="ini.memcache.allow-failover">
   <span class="term">
    <i><tt class="parameter">memcache.allow_failover</tt></i>

    <a href="language.types.boolean.html" class="type boolean">boolean</a>
   </span>
   <dd>

    <p class="para">
     Whether to transparently failover to other servers on 
     errors.
    </p>
   </dd>

  </dt>

  
  <dt id="ini.memcache.max-failover-attempts">
   <span class="term">
    <i><tt class="parameter">memcache.max_failover_attempts</tt></i>

    <a href="language.types.integer.html" class="type integer">integer</a>
   </span>
   <dd>

    <p class="para">
     Defines how many servers to try when setting and getting data.
     Used only in conjunction with memcache.allow_failover.
    </p>
   </dd>

  </dt>

  
  <dt id="ini.memcache.chunk-size">
   <span class="term">
    <i><tt class="parameter">memcache.chunk_size</tt></i>

    <a href="language.types.integer.html" class="type integer">integer</a>
   </span>
   <dd>

    <p class="para">
     Data will be transferred in chunks of this size, setting
     the value lower requires more network writes. Try 
     increasing this value to 32768 if noticing otherwise 
     inexplicable slowdowns.
    </p>
   </dd>

  </dt>

  
  <dt id="ini.memcache.default-port">
   <span class="term">
    <i><tt class="parameter">memcache.default_port</tt></i>

    <a href="language.types.string.html" class="type string">string</a>
   </span>
   <dd>

    <p class="para">
     The default TCP port number to use when connecting to
     the memcached server if no other port is specified.
    </p>
   </dd>

  </dt>


  <dt id="ini.memcache.hash-strategy">
   <span class="term">
    <i><tt class="parameter">memcache.hash_strategy</tt></i>

    <a href="language.types.string.html" class="type string">string</a>
   </span>
   <dd>

    <p class="para">
     Controls which strategy to use when mapping keys to servers. Set this value to 
     <i class="literal">consistent</i> to enable consistent hashing which allows servers 
     to be added or removed from the pool without causing keys to be remapped.
     Setting this value to <i class="literal">standard</i> results in the old strategy
     being used.
    </p>
   </dd>

  </dt>

  
  <dt id="ini.memcache.hash-function">
   <span class="term">
    <i><tt class="parameter">memcache.hash_function</tt></i>

    <a href="language.types.string.html" class="type string">string</a>
   </span>
   <dd>

    <p class="para">
     Controls which hash function to apply when mapping keys to servers, <i class="literal">crc32</i> 
     uses the standard CRC32 hash while <i class="literal">fnv</i> uses FNV-1a.
    </p>
   </dd>

  </dt>


  <dt id="ini.memcache.session-handler">
   <span class="term">
    <i><tt class="parameter">session.save_handler</tt></i>

    <a href="language.types.string.html" class="type string">string</a>
   </span>
   <dd>

    <p class="para">
     Use memcache as a session handler by setting this value to <i class="literal">memcache</i>.
    </p>
   </dd>

  </dt>


  <dt id="ini.memcache.save-path">
   <span class="term">
    <i><tt class="parameter">session.save_path</tt></i>

    <a href="language.types.string.html" class="type string">string</a>
   </span>
   <dd>

    <p class="para">
     Defines a comma separated of server urls to use for session storage, for example
     <i class="literal">&quot;tcp://host1:11211, tcp://host2:11211&quot;</i>.
    </p>
    <p class="para">
     Each url may contain parameters which are applied to that server, they are the same 
     as for the <b>Memcache::addServer()</b> method. For example 
     <i class="literal">&quot;tcp://host1:11211?persistent=1&amp;weight=1&amp;timeout=1&amp;retry_interval=15&quot;</i>
    </p>
   </dd>

  </dt>


 </dl>

</p>
</div>




   <div id="memcache.resources" class="section">
    <h2 class="title">Resource Types</h2>
    <p class="para">
     There is only one resource type used in memcache module - it&#039;s
     the link identifier for a cache server connection.
    </p>
   </div>

   

<div id="memcache.constants" class="section">
 <h2 class="title">Predefined Constants</h2>
 <table border="5">
  <caption><b>Memcache Constants</b></caption>
   <colgroup>

    <thead valign="middle">
     <tr valign="middle">
      <th colspan="1">Name</th>
      <th colspan="1">Description</th>
     </tr>

    </thead>

    <tbody valign="middle">
     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">
       <b><tt>MEMCACHE_COMPRESSED</tt></b>
       (<a href="language.types.integer.html" class="type integer">integer</a>)
      </td>
      <td colspan="1" rowspan="1" align="left">
       Used to turn on-the-fly data compression on with
       <b>Memcache::set()</b>, 
       <b>Memcache::add()</b> and
       <b>Memcache::replace()</b>.
      </td>
     </tr>

     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">
       <b><tt>MEMCACHE_HAVE_SESSION</tt></b>
       (<a href="language.types.integer.html" class="type integer">integer</a>)
      </td>
      <td colspan="1" rowspan="1" align="left">
       1 if this Memcache session handler is available, 0 otherwise.
      </td>
     </tr>

    </tbody>
   </colgroup>

  </table>

</div>




   <div id="memcache.examples" class="section">
   <h2 class="title">Examples</h2>
    <p class="para">
     <div class="example">
      <p><b>Example#1 memcache extension overview example</b></p>
      <div class="example-contents"><p>
       In this example, an object is being saved in the cache and then
       retrieved back. Object and other non-scalar types are serialized
       before saving, so it&#039;s impossible to store resources (i.e. connection
       identifiers and others) in the cache.
      </p></div>
      <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$memcache&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Memcache</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$memcache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'localhost'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">)&nbsp;or&nbsp;die&nbsp;(</span><span style="color: #DD0000">"Could&nbsp;not&nbsp;connect"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$version&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$memcache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getVersion</span><span style="color: #007700">();<br />echo&nbsp;</span><span style="color: #DD0000">"Server's&nbsp;version:&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">$version</span><span style="color: #007700">.</span><span style="color: #DD0000">"&lt;br/&gt;\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$tmp_object&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">stdClass</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$tmp_object</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">str_attr&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'test'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$tmp_object</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">int_attr&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">123</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$memcache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set</span><span style="color: #007700">(</span><span style="color: #DD0000">'key'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$tmp_object</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">)&nbsp;or&nbsp;die&nbsp;(</span><span style="color: #DD0000">"Failed&nbsp;to&nbsp;save&nbsp;data&nbsp;at&nbsp;the&nbsp;server"</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">"Store&nbsp;data&nbsp;in&nbsp;the&nbsp;cache&nbsp;(data&nbsp;will&nbsp;expire&nbsp;in&nbsp;10&nbsp;seconds)&lt;br/&gt;\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$get_result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$memcache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #DD0000">'key'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">"Data&nbsp;from&nbsp;the&nbsp;cache:&lt;br/&gt;\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$get_result</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
      </div>

     </div>
    </p>
    <p class="para">
     <div class="example">
      <p><b>Example#2 Using memcache session handler</b></p>
      <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$session_save_path&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"tcp://$host:$port?persistent=1&amp;weight=2&amp;timeout=2&amp;retry_interval=10,&nbsp;&nbsp;,tcp://$host:$port&nbsp;&nbsp;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">ini_set</span><span style="color: #007700">(</span><span style="color: #DD0000">'session.save_handler'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'memcache'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">ini_set</span><span style="color: #007700">(</span><span style="color: #DD0000">'session.save_path'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$session_save_path</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
      </div>

     </div>
    </p>
   </div>

  </div>

  



















































































































 <h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.Memcache-add.html">Memcache::add</a> — Add an item to the server</li><li><a href="function.Memcache-addServer.html">Memcache::addServer</a> — Add a memcached server to connection pool</li><li><a href="function.Memcache-close.html">Memcache::close</a> — Close memcached server connection</li><li><a href="function.Memcache-connect.html">Memcache::connect</a> — Open memcached server connection</li><li><a href="function.memcache-debug.html">memcache_debug</a> — Turn debug output on/off</li><li><a href="function.Memcache-decrement.html">Memcache::decrement</a> — Decrement item's value</li><li><a href="function.Memcache-delete.html">Memcache::delete</a> — Delete item from the server</li><li><a href="function.Memcache-flush.html">Memcache::flush</a> — Flush all existing items at the server</li><li><a href="function.Memcache-get.html">Memcache::get</a> — Retrieve item from the server</li><li><a href="function.Memcache-getExtendedStats.html">Memcache::getExtendedStats</a> — Get statistics from all servers in pool</li><li><a href="function.Memcache-getServerStatus.html">Memcache::getServerStatus</a> — Returns server status</li><li><a href="function.Memcache-getStats.html">Memcache::getStats</a> — Get statistics of the server</li><li><a href="function.Memcache-getVersion.html">Memcache::getVersion</a> — Return version of the server</li><li><a href="function.Memcache-increment.html">Memcache::increment</a> — Increment item's value</li><li><a href="function.Memcache-pconnect.html">Memcache::pconnect</a> — Open memcached server persistent connection</li><li><a href="function.Memcache-replace.html">Memcache::replace</a> — Replace value of the existing item</li><li><a href="function.Memcache-set.html">Memcache::set</a> — Store data at the server</li><li><a href="function.Memcache-setCompressThreshold.html">Memcache::setCompressThreshold</a> — Enable automatic compression of large values</li><li><a href="function.Memcache-setServerParams.html">Memcache::setServerParams</a> — Changes server parameters and status at runtime</li></ul>
</div>
<hr /><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="function.m-verifysslcert.html">m_verifysslcert</a></div>
 <div class="next" style="float: right;"><a href="function.Memcache-add.html">Memcache::add</a></div>
 <div class="up"><a href="funcref.html">Function Reference</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
