<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <title>Process Control Functions</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
 </head>
 <body><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="function.parsekit-func-arginfo.html">parsekit_func_arginfo</a></div>
 <div class="next" style="float: right;"><a href="function.pcntl-alarm.html">pcntl_alarm</a></div>
 <div class="up"><a href="funcref.html">Function Reference</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div>
  <h1 class="title">Process Control Functions</h1>
  

  <div class="partintro">
   <div id="pcntl.intro" class="section">
    <h2 class="title">Introduction</h2>
    <p class="para">
     Process Control support in PHP implements the Unix style of
     process creation, program execution, signal handling and process
     termination. Process Control should not be enabled within a
     web server environment and unexpected results may happen if any
     Process Control functions are used within a web server environment.
    </p>
    <p class="para">
     This documentation is intended to explain the general usage of
     each of the Process Control functions. For detailed information
     about Unix process control you are encouraged to consult your
     systems documentation including fork(2), waitpid(2) and signal(2)
     or a comprehensive reference such as Advanced Programming in the
     UNIX Environment by W. Richard Stevens (Addison-Wesley).
    </p>
    <p class="para">
     PCNTL now uses ticks as the signal handle callback mechanism, which is
     much faster than the previous mechanism. This change follows the same
     semantics as using &quot;user ticks&quot;. You use the <b>declare()</b> 
     statement to specify the locations in your program where callbacks are
     allowed to occur. This allows you to minimize the overhead of handling
     asynchronous events. In the past, compiling PHP with pcntl enabled would
     always incur this overhead, whether or not your script actually used
     pcntl.
    </p>
    <p class="para">
     There is one adjustment that all pcntl scripts prior to PHP 4.3.0 must
     make for them to work which is to either to use
     <b>declare()</b> on a section where you wish to allow
     callbacks or to just enable it across the entire script using 
     the new global syntax of <b>declare()</b>.
    </p>

    <blockquote><p><b class="note">Note</b>: <span class="simpara">This extension is not
available on Windows platforms.</span></p></blockquote>
   </div>

   <div id="pcntl.requirements" class="section">
    <h2 class="title">Requirements</h2>
    <p class="para">No external libraries are needed to build this extension.</p>
   </div>

   

<div id="pcntl.installation" class="section">
 <h2 class="title">Installation</h2>
 <p class="para">
  Process Control support in PHP is not enabled by default.
  You have to compile the CGI or CLI version of PHP with
  <span class="option">--enable-pcntl</span> configuration
  option when compiling PHP to enable Process Control support.
 </p>
 <blockquote><p><b class="note">Note</b>: 
  
   Currently, this module will not function on non-Unix platforms
   (Windows).
  <br />
 </p></blockquote>
</div>





   <div id="pcntl.configuration" class="section">
    <h2 class="title">Runtime Configuration</h2>
    <p class="para">This extension has no configuration directives defined in <var class="filename">php.ini</var>.</p>
   </div>

   <div id="pcntl.resources" class="section">
    <h2 class="title">Resource Types</h2>
    <p class="para">This extension has no resource types defined.</p>
   </div>

   

<div id="pcntl.constants" class="section">
 <h2 class="title">Predefined Constants</h2>
 <p class="para">
  The following list of signals are supported by the Process Control
  functions. Please see your systems signal(7) man page for details
  of the default behavior of these signals.
 </p>
 <dl>

  <dt>

   <span class="term">
    <b><tt>WNOHANG</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>WUNTRACED</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIG_IGN</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIG_DFL</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIG_ERR</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGHUP</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGINT</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGQUIT</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGILL</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGTRAP</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGABRT</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGIOT</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGBUS</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGFPE</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGKILL</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGUSR1</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGSEGV</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGUSR2</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGPIPE</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGALRM</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGTERM</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGSTKFLT</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGCLD</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGCHLD</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGCONT</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGSTOP</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGTSTP</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGTTIN</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGTTOU</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGURG</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGXCPU</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGXFSZ</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGVTALRM</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGPROF</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGWINCH</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGPOLL</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGIO</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGPWR</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGSYS</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>SIGBABY</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

 </dl>

</div>




   <div id="pcntl.example" class="section">
    <h2 class="title">Examples</h2>
    <p class="para">
     This example forks off a daemon process with a signal handler.
    </p>
    <div class="example">
     <p><b>Example#1 Process Control Example</b></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">declare(</span><span style="color: #0000BB">ticks</span><span style="color: #007700">=</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$pid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">pcntl_fork</span><span style="color: #007700">();<br />if&nbsp;(</span><span style="color: #0000BB">$pid&nbsp;</span><span style="color: #007700">==&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">"could&nbsp;not&nbsp;fork"</span><span style="color: #007700">);&nbsp;<br />}&nbsp;else&nbsp;if&nbsp;(</span><span style="color: #0000BB">$pid</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit();&nbsp;</span><span style="color: #FF8000">//&nbsp;we&nbsp;are&nbsp;the&nbsp;parent&nbsp;<br /></span><span style="color: #007700">}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;we&nbsp;are&nbsp;the&nbsp;child<br /></span><span style="color: #007700">}<br /><br /></span><span style="color: #FF8000">//&nbsp;detatch&nbsp;from&nbsp;the&nbsp;controlling&nbsp;terminal<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">posix_setsid</span><span style="color: #007700">()&nbsp;==&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">"could&nbsp;not&nbsp;detach&nbsp;from&nbsp;terminal"</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;setup&nbsp;signal&nbsp;handlers<br /></span><span style="color: #0000BB">pcntl_signal</span><span style="color: #007700">(</span><span style="color: #0000BB">SIGTERM</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"sig_handler"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">pcntl_signal</span><span style="color: #007700">(</span><span style="color: #0000BB">SIGHUP</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"sig_handler"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;loop&nbsp;forever&nbsp;performing&nbsp;tasks<br /></span><span style="color: #007700">while&nbsp;(</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;do&nbsp;something&nbsp;interesting&nbsp;here<br /><br /></span><span style="color: #007700">}<br /><br />function&nbsp;</span><span style="color: #0000BB">sig_handler</span><span style="color: #007700">(</span><span style="color: #0000BB">$signo</span><span style="color: #007700">)&nbsp;<br />{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(</span><span style="color: #0000BB">$signo</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">SIGTERM</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;handle&nbsp;shutdown&nbsp;tasks<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">exit;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">SIGHUP</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;handle&nbsp;restart&nbsp;tasks<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">break;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;handle&nbsp;all&nbsp;other&nbsp;signals<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br />}<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </div>

   <div id="pcntl.seealso" class="section">
    <h2 class="title">See Also</h2>
    <p class="para">
     A look at the section about
     <a href="ref.posix.html" class="link">POSIX functions</a>
     may be useful.
    </p>
   </div>

  </div>























































































 <h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.pcntl-alarm.html">pcntl_alarm</a> — Set an alarm clock for delivery of a signal</li><li><a href="function.pcntl-exec.html">pcntl_exec</a> — Executes specified program in current process space</li><li><a href="function.pcntl-fork.html">pcntl_fork</a> — Forks the currently running process</li><li><a href="function.pcntl-getpriority.html">pcntl_getpriority</a> — Get the priority of any process</li><li><a href="function.pcntl-setpriority.html">pcntl_setpriority</a> — Change the priority of any process</li><li><a href="function.pcntl-signal.html">pcntl_signal</a> — Installs a signal handler</li><li><a href="function.pcntl-wait.html">pcntl_wait</a> — Waits on or returns the status of a forked child</li><li><a href="function.pcntl-waitpid.html">pcntl_waitpid</a> — Waits on or returns the status of a forked child</li><li><a href="function.pcntl-wexitstatus.html">pcntl_wexitstatus</a> — Returns the return code of a terminated child</li><li><a href="function.pcntl-wifexited.html">pcntl_wifexited</a> — Checks if status code represents a normal exit</li><li><a href="function.pcntl-wifsignaled.html">pcntl_wifsignaled</a> — Checks whether the status code represents a termination due to a signal</li><li><a href="function.pcntl-wifstopped.html">pcntl_wifstopped</a> — Checks whether the child process is currently stopped</li><li><a href="function.pcntl-wstopsig.html">pcntl_wstopsig</a> — Returns the signal which caused the child to stop</li><li><a href="function.pcntl-wtermsig.html">pcntl_wtermsig</a> — Returns the signal which caused the child to terminate</li></ul>
</div>
<hr /><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="function.parsekit-func-arginfo.html">parsekit_func_arginfo</a></div>
 <div class="next" style="float: right;"><a href="function.pcntl-alarm.html">pcntl_alarm</a></div>
 <div class="up"><a href="funcref.html">Function Reference</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
