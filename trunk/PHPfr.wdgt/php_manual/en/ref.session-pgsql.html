<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <title>PostgreSQL Session Save Handler</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
 </head>
 <body><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="function.sesam-settransaction.html">sesam_settransaction</a></div>
 <div class="next" style="float: right;"><a href="function.session-pgsql-add-error.html">session_pgsql_add_error</a></div>
 <div class="up"><a href="funcref.html">Function Reference</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div>
 <h1 class="title">PostgreSQL Session Save Handler</h1>
 

  <div class="partintro">
   <div id="session-pgsql.intro" class="section">
    <h2 class="title">Introduction</h2>
    <blockquote><p><b class="note">Note</b>: <span class="simpara">This extension is not
available on Windows platforms.</span></p></blockquote>
    <p class="para">
     This module provides an additional session save handler for the
     <a href="ref.session.html" class="link">session</a>
     module using <a href="http://www.postgresql.org/" class="link external">&raquo; PostgreSQL</a> as a
     storage system. A <i class="literal">user-level</i> session storage function may
     also be used - <a href="function.session-set-save-handler.html" class="function">session_set_save_handler()</a>, but this module is
     written in C and therefore could be twice as fast, compared to
     a session save handler written in PHP.
    </p>
    <p class="para">
     Session PgSQL is designed to scale any size of web sites and offers some
     advanced features:
     <ul class="simplelist">
      <li class="member">session tables are created automatically</li>
      <li class="member">automatic session table vacuum</li>
      <li class="member">better garbage collection</li>
      <li class="member">multiple PostgreSQL servers support</li>
      <li class="member">automatic database server failover (switching)</li>
      <li class="member">
       automatic database server load balancing if there are multiple
       PostgreSQL servers.
      </li>
      <li class="member">short circuit UPDATE</li>
     </ul> 
    </p>
   </div>

   <div id="session-pgsql.requirements" class="section">
    <h2 class="title">Requirements</h2>
    <p class="para">
     You need at least PHP &gt;= 4.3.0, and PostgreSQL &gt;=7.2.0 as database
     server. <i class="literal">libpq</i> that comes with PostgreSQL 7.2.0 or
     later (and header files to build) and <a href="http://www.ossp.org/pkg/lib/mm/" class="link external">&raquo; libmm</a>
     (and header files).
    </p>
   </div>

   

<div id="session-pgsql.installation" class="section">
 <h2 class="title">Installation</h2>
 <p class="para">
  Short installation note:
  <ul class="itemizedlist">
   <li class="listitem">
    <span class="simpara">
     Untar the <i class="literal">tar.gz</i> archive into
     <var class="filename">php4/ext</var> (Latest official releases
     can be found at SourceForge
     <a href="http://sourceforge.net/projects/phpform-ext/" class="link external">&raquo; PHP Form Extension Project</a>)
    </span>
   </li>
   <li class="listitem">
    <span class="simpara">
     If the new directory is now called something like
     <i class="literal">session_pgsql</i>. You should name it to
     <i class="literal">session_pgsql</i> (except you only want to build it as
     self-contained php-module).
    </span>
   </li>
   <li class="listitem">
    <span class="simpara">Run <strong class="userinput"><code>./buildconf</code></strong>
 in php4</span>
   </li>
   <li class="listitem">
    <span class="simpara">
     Run <strong class="userinput"><code>configure</code></strong>

     <span class="option">--with-session-pgsql</span> (and your other
     options)
    </span>
   </li>
   <li class="listitem">
    <span class="simpara"><strong class="userinput"><code>make; make install</code></strong>
</span>
   </li>
  </ul>
 </p>
</div>




   

<div id="session-pgsql.configuration" class="section">
 <h2 class="title">Runtime Configuration</h2>
 <p class="simpara">
The behaviour of these functions is affected by settings in <var class="filename">php.ini</var>.
</p>
 <p class="para">
  PostgreSQL session save handler is still under development. Refer to the
  <var class="filename">README</var> file in the source distribution for
  configuration details.
 </p>
</div>




   <div id="session-pgsql.tables" class="section">
    <h2 class="title">Table definitions</h2>
    <p class="para">Session table definition
     <div class="example-contents">
<div class="cdata"><pre>
CREATE TABLE php_session (
  sess_id            text,
  sess_name          text,
  sess_data          text,
  sess_created       integer,
  sess_modified      integer,
  sess_expire        integer,
  sess_addr_created  text,
  sess_addr_modified text,
  sess_counter       integer,
  sess_error         integer,
  sess_warning       integer,
  sess_notice        integer,
  sess_err_message   text,
  sess_custom        text
);

CREATE INDEX php_session_idx ON php_session USING BTREE (sess_id);
</pre></div>
     </div>

    </p>
    <div class="warning"><b class="warning">Warning</b>
     <p class="para">
      If you use <i class="literal">HASH</i> for <i class="literal">INDEX</i>, you&#039;ll
      have a deadlock problem when the server load is
      <em class="emphasis">very</em> high. Even if it&#039;s unlikely to have a deadlock
      under normal operation, it can occur. <em class="emphasis">Do not use
      <i class="literal">HASH</i> for <i class="literal">INDEX</i></em>.
     </p>
    </div>
    <p class="para">
     You may change the session table as long as all fields are defined.
    </p>
    <p class="para">
     Application variables table definition
     <div class="example-contents">
<div class="cdata"><pre>
CREATE TABLE php_app_vars (
  app_modified       integer,
  app_name           text,
  app_vars           text
);
</pre></div>
     </div>

    </p>
   </div>


   <div id="session-pgsql.contact" class="section">
    <h2 class="title">Contact Information</h2>
    <p class="para">
     I have at the moment not very much time to further develop this
     extension. I will implement more and more features in the near future.
    </p>
    <p class="para">
     If you have comments, bug fixes, enhancements or want to help developing
     this, you can drop me a mail at
     <a href="mailto:yohgaki@php.net" class="link external">&raquo; yohgaki@php.net</a>. Any help is
     very welcome.
    </p>
   </div>
  </div>














































 <h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.session-pgsql-add-error.html">session_pgsql_add_error</a> — Increments error counts and sets last error message</li><li><a href="function.session-pgsql-get-error.html">session_pgsql_get_error</a> — Returns number of errors and last error message</li><li><a href="function.session-pgsql-get-field.html">session_pgsql_get_field</a> — Get custom field value</li><li><a href="function.session-pgsql-reset.html">session_pgsql_reset</a> — Reset connection to session database servers</li><li><a href="function.session-pgsql-set-field.html">session_pgsql_set_field</a> — Set custom field value</li><li><a href="function.session-pgsql-status.html">session_pgsql_status</a> — Get current save handler status</li></ul>
</div>
<hr /><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="function.sesam-settransaction.html">sesam_settransaction</a></div>
 <div class="next" style="float: right;"><a href="function.session-pgsql-add-error.html">session_pgsql_add_error</a></div>
 <div class="up"><a href="funcref.html">Function Reference</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
